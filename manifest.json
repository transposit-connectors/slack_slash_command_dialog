{
  "v2": {
    "transposit": {
      "dependencies": [{
        "name": "transposit/slack:v1.*.*",
        "alias": "slack"
      }, {
        "name": "transposit/slack:v1.*.*",
        "alias": "slackbot"
      }],
      "operations": [{
        "id": "webhook",
        "description": "Activates when /helpdesk is called in Slack",
        "function": {
          "parameters": [{
            "name": "http_event",
            "default": {
              "text": "{\"http_method\": \"GET\", \"query_parameters\": {}, \"headers\": {}, \"body\": \"\"}"
            },
            "type": "OBJECT"
          }],
          "js": "webhook.js"
        },
        "access": {
          "requireApiKey": true,
          "webhook": true
        }
      }, {
        "id": "helpdesk",
        "description": "The dialog that opens when helpdesk is called",
        "tql": {
          "parameters": [{
            "name": "trigger_id",
            "type": "STRING"
          }, {
            "name": "email",
            "type": "STRING"
          }, {
            "name": "text",
            "type": "STRING"
          }, {
            "name": "title",
            "type": "STRING"
          }, {
            "name": "description",
            "type": "STRING"
          }, {
            "name": "urgency",
            "type": "STRING"
          }],
          "tql": "SELECT * FROM slackbot.open_dialog\n  WHERE $body=(SELECT {\n    'trigger_id' : @trigger_id,\n    'dialog': [\n      {\n        'title': @email,\n        -- Get this from the 3rd party helpdesk system\n        'title_link': 'http://example.com',\n        'text': @text,\n        'fields': [\n          {\n            'title': 'Title',\n            'value': @title,\n          },\n          {\n            'title': 'Description',\n            'value': @description,\n          },\n          {\n            'title': 'Status',\n            'value': 'Open',\n            'short': true,\n          },\n          {\n            'title': 'Urgency',\n            'value': @urgency,\n            'short': true,\n          },\n        ],\n      },\n    ]\n})\n"
        }
      }],
      "dataConnections": [{
        "ref": "slackbot.raw",
        "overrides": {
          "swagger": {
            "oauthConfig": {
              "scope": "bot,commands,chat:write:bot",
              "accessTokenPath": "bot.bot_access_token"
            },
            "executionLimits": {
            }
          }
        }
      }],
      "javascriptAPIVersion": "3",
      "source": "src",
      "userSettingsDisplay": "GENERATED"
    }
  }
}